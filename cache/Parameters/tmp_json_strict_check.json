{
  "generated_at": "2025-12-30T16:52:28Z",
  "models": {
    "baseline": {
      "path": "model/Baseline/best_model.h5",
      "type": "Siamese CNN (MobileNetV2)",
      "param_count": 3064704,
      "input": [
        224,
        224,
        3
      ]
    },
    "proposed": {
      "path": "model/final_best_model.keras",
      "type": "Siamese Capsule Network + Attention + MobileNetV2 Ensemble",
      "param_count": 2257984,
      "input": [
        224,
        224,
        3
      ],
      "mnetv2_weight": 0.4,
      "use_mnetv2": true
    }
  },
  "dataset": {
    "csv": "data/processed_data/val_pairs.csv",
    "data_root": "data",
    "label_strategy": "CSV label column (0/1) where 1 means similar.",
    "pair_count": 50
  },
  "parameters_definition": [
    {
      "name": "Ears Region",
      "key": "ears_region",
      "definition": "Top 20% of detected pet bounding box (proxy for ears/head top)."
    },
    {
      "name": "Eyes Region",
      "key": "eyes_region",
      "definition": "Next 20% band inside the pet bbox (proxy for eyes/upper face)."
    },
    {
      "name": "Muzzle/Snout Region",
      "key": "muzzle_region",
      "definition": "Middle 20% band inside the pet bbox (proxy for nose/snout)."
    },
    {
      "name": "Fur/Body Region",
      "key": "fur_body_region",
      "definition": "Lower 40% inside the pet bbox (proxy for coat texture/pattern/body shape)."
    },
    {
      "name": "Background",
      "key": "background",
      "definition": "Pixels outside detected pet bbox (proxy for background reliance / spurious cues)."
    }
  ],
  "scenarios": {
    "normal": {
      "thresholds": {
        "baseline": {
          "best_threshold": 0.7370699048042297,
          "metrics_at_best": {
            "accuracy": 0.94,
            "precision": 0.8333333333333334,
            "recall": 1.0,
            "f1": 0.9090909090909091
          },
          "confusion": {
            "TP": 15,
            "TN": 32,
            "FP": 3,
            "FN": 0
          }
        },
        "proposed": {
          "best_threshold": 0.510688066482544,
          "metrics_at_best": {
            "accuracy": 0.94,
            "precision": 0.9285714285714286,
            "recall": 0.8666666666666667,
            "f1": 0.896551724137931
          },
          "confusion": {
            "TP": 13,
            "TN": 34,
            "FP": 1,
            "FN": 2
          }
        }
      },
      "roc": {
        "baseline": {
          "auc": 0.9714285714285714,
          "fpr": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.02857142857142857,
            0.02857142857142857,
            0.05714285714285714,
            0.05714285714285714,
            0.05714285714285714,
            0.05714285714285714,
            0.05714285714285714,
            0.08571428571428572,
            0.08571428571428572,
            0.08571428571428572,
            0.11428571428571428,
            0.14285714285714285,
            0.17142857142857143,
            0.2,
            0.22857142857142856,
            0.2571428571428571,
            0.2857142857142857,
            0.3142857142857143,
            0.34285714285714286,
            0.37142857142857144,
            0.4,
            0.42857142857142855,
            0.45714285714285713,
            0.4857142857142857,
            0.5142857142857142,
            0.5428571428571428,
            0.5714285714285714,
            0.6,
            0.6285714285714286,
            0.6571428571428571,
            0.6857142857142857,
            0.7142857142857143,
            0.7428571428571429,
            0.7714285714285715,
            0.8,
            0.8285714285714286,
            0.8571428571428571,
            0.8857142857142857,
            0.9142857142857143,
            0.9428571428571428,
            0.9714285714285714,
            1.0,
            1.0
          ],
          "tpr": [
            0.0,
            0.06666666666666667,
            0.13333333333333333,
            0.2,
            0.26666666666666666,
            0.3333333333333333,
            0.4,
            0.4666666666666667,
            0.5333333333333333,
            0.5333333333333333,
            0.6,
            0.6,
            0.6666666666666666,
            0.7333333333333333,
            0.8,
            0.8666666666666667,
            0.8666666666666667,
            0.9333333333333333,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0
          ],
          "thresholds": [
            null,
            0.982150137424469,
            0.9635244607925415,
            0.9522190690040588,
            0.94757080078125,
            0.9426702857017517,
            0.9204718470573425,
            0.9188575744628906,
            0.9098140001296997,
            0.8859347105026245,
            0.8788940906524658,
            0.8741866946220398,
            0.8732481598854065,
            0.8682120442390442,
            0.8159186840057373,
            0.8157976865768433,
            0.7773138880729675,
            0.7677301168441772,
            0.7370699048042297,
            0.4947906732559204,
            0.48792728781700134,
            0.40853187441825867,
            0.3868892192840576,
            0.3499525785446167,
            0.3489804267883301,
            0.31792938709259033,
            0.30705034732818604,
            0.30008402466773987,
            0.24026726186275482,
            0.21377290785312653,
            0.20983685553073883,
            0.2027423232793808,
            0.19309207797050476,
            0.1873602718114853,
            0.18323785066604614,
            0.1790838986635208,
            0.17472761869430542,
            0.1726209670305252,
            0.16758356988430023,
            0.16673247516155243,
            0.16347819566726685,
            0.16064251959323883,
            0.1539861559867859,
            0.15243025124073029,
            0.1518971472978592,
            0.14232036471366882,
            0.1417468786239624,
            0.13799147307872772,
            0.13734564185142517,
            0.13728876411914825,
            0.13659417629241943,
            null
          ]
        },
        "proposed": {
          "auc": 0.96,
          "fpr": [
            0.0,
            0.0,
            0.0,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.05714285714285714,
            0.08571428571428572,
            0.11428571428571428,
            0.11428571428571428,
            0.14285714285714285,
            0.17142857142857143,
            0.17142857142857143,
            0.2,
            0.22857142857142856,
            0.2571428571428571,
            0.2857142857142857,
            0.3142857142857143,
            0.34285714285714286,
            0.37142857142857144,
            0.4,
            0.42857142857142855,
            0.45714285714285713,
            0.4857142857142857,
            0.5142857142857142,
            0.5428571428571428,
            0.5714285714285714,
            0.6,
            0.6285714285714286,
            0.6571428571428571,
            0.6857142857142857,
            0.7142857142857143,
            0.7428571428571429,
            0.7714285714285715,
            0.8,
            0.8285714285714286,
            0.8571428571428571,
            0.8857142857142857,
            0.9142857142857143,
            0.9428571428571428,
            0.9714285714285714,
            1.0,
            1.0
          ],
          "tpr": [
            0.0,
            0.06666666666666667,
            0.13333333333333333,
            0.13333333333333333,
            0.2,
            0.26666666666666666,
            0.3333333333333333,
            0.4,
            0.4666666666666667,
            0.5333333333333333,
            0.6,
            0.6666666666666666,
            0.7333333333333333,
            0.8,
            0.8666666666666667,
            0.8666666666666667,
            0.8666666666666667,
            0.8666666666666667,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0
          ],
          "thresholds": [
            null,
            0.7641836404800415,
            0.6769416928291321,
            0.6683402061462402,
            0.6624404191970825,
            0.6400938630104065,
            0.6018691062927246,
            0.5784766674041748,
            0.5611135363578796,
            0.5513718128204346,
            0.5487335324287415,
            0.5444121956825256,
            0.53989577293396,
            0.5398390889167786,
            0.510688066482544,
            0.508620023727417,
            0.49388808012008667,
            0.48297691345214844,
            0.4786943793296814,
            0.4721074402332306,
            0.4572340250015259,
            0.3907899260520935,
            0.38765785098075867,
            0.35164472460746765,
            0.3445965349674225,
            0.3282209038734436,
            0.3195376396179199,
            0.2868068218231201,
            0.26822927594184875,
            0.2655720114707947,
            0.26140356063842773,
            0.26103562116622925,
            0.2548701763153076,
            0.25287526845932007,
            0.2423679530620575,
            0.24061277508735657,
            0.23931866884231567,
            0.23721525073051453,
            0.2297498881816864,
            0.2242487519979477,
            0.2214101105928421,
            0.2203008085489273,
            0.21957407891750336,
            0.21014682948589325,
            0.19679220020771027,
            0.19566911458969116,
            0.18849141895771027,
            0.18435746431350708,
            0.18206489086151123,
            0.15022289752960205,
            0.08179059624671936,
            null
          ]
        }
      },
      "region_attribution_avg_percent": {
        "baseline": {
          "ears_region": 0.0,
          "eyes_region": 0.0,
          "muzzle_region": 0.0,
          "fur_body_region": 0.0,
          "background": 0.0
        },
        "proposed": {
          "ears_region": 0.0,
          "eyes_region": 0.0,
          "muzzle_region": 0.0,
          "fur_body_region": 0.0,
          "background": 0.0
        }
      },
      "examples": {
        "baseline": [],
        "proposed": []
      }
    },
    "lowlight": {
      "thresholds": {
        "baseline": {
          "best_threshold": 0.43717238306999207,
          "metrics_at_best": {
            "accuracy": 0.82,
            "precision": 0.6666666666666666,
            "recall": 0.8,
            "f1": 0.7272727272727272
          },
          "confusion": {
            "TP": 12,
            "TN": 29,
            "FP": 6,
            "FN": 3
          }
        },
        "proposed": {
          "best_threshold": 0.4277219772338867,
          "metrics_at_best": {
            "accuracy": 0.8,
            "precision": 0.6086956521739131,
            "recall": 0.9333333333333333,
            "f1": 0.7368421052631579
          },
          "confusion": {
            "TP": 14,
            "TN": 26,
            "FP": 9,
            "FN": 1
          }
        }
      },
      "roc": {
        "baseline": {
          "auc": 0.8495238095238095,
          "fpr": [
            0.0,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.02857142857142857,
            0.05714285714285714,
            0.05714285714285714,
            0.08571428571428572,
            0.08571428571428572,
            0.11428571428571428,
            0.11428571428571428,
            0.11428571428571428,
            0.11428571428571428,
            0.11428571428571428,
            0.14285714285714285,
            0.14285714285714285,
            0.17142857142857143,
            0.17142857142857143,
            0.17142857142857143,
            0.2,
            0.22857142857142856,
            0.2571428571428571,
            0.2857142857142857,
            0.2857142857142857,
            0.3142857142857143,
            0.3142857142857143,
            0.34285714285714286,
            0.37142857142857144,
            0.4,
            0.42857142857142855,
            0.45714285714285713,
            0.4857142857142857,
            0.4857142857142857,
            0.5142857142857142,
            0.5428571428571428,
            0.5714285714285714,
            0.6,
            0.6285714285714286,
            0.6571428571428571,
            0.6857142857142857,
            0.7142857142857143,
            0.7428571428571429,
            0.7714285714285715,
            0.8,
            0.8285714285714286,
            0.8571428571428571,
            0.8857142857142857,
            0.9142857142857143,
            0.9428571428571428,
            0.9714285714285714,
            1.0,
            1.0
          ],
          "tpr": [
            0.0,
            0.0,
            0.06666666666666667,
            0.13333333333333333,
            0.2,
            0.2,
            0.26666666666666666,
            0.26666666666666666,
            0.3333333333333333,
            0.3333333333333333,
            0.4,
            0.4666666666666667,
            0.5333333333333333,
            0.6,
            0.6,
            0.6666666666666666,
            0.6666666666666666,
            0.7333333333333333,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8,
            0.8666666666666667,
            0.8666666666666667,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0
          ],
          "thresholds": [
            null,
            0.9106441736221313,
            0.89725661277771,
            0.8950486183166504,
            0.8923799991607666,
            0.8780170679092407,
            0.8508318066596985,
            0.8451494574546814,
            0.7978512048721313,
            0.7744467258453369,
            0.7519276142120361,
            0.7303019165992737,
            0.6669527888298035,
            0.631533682346344,
            0.594954252243042,
            0.522962212562561,
            0.5177884697914124,
            0.5161542892456055,
            0.43717238306999207,
            0.4120786488056183,
            0.38704919815063477,
            0.3372395932674408,
            0.3321562707424164,
            0.25896474719047546,
            0.2339896708726883,
            0.21690890192985535,
            0.2137521505355835,
            0.2133890837430954,
            0.19661901891231537,
            0.19466857612133026,
            0.18839173018932343,
            0.18605759739875793,
            0.18252524733543396,
            0.18212147057056427,
            0.18197126686573029,
            0.18195433914661407,
            0.17574569582939148,
            0.17155654728412628,
            0.17044231295585632,
            0.16468599438667297,
            0.16337715089321136,
            0.1515059918165207,
            0.14661188423633575,
            0.14218412339687347,
            0.1420835703611374,
            0.141122505068779,
            0.14056409895420074,
            0.13957878947257996,
            0.13845059275627136,
            0.13774418830871582,
            0.13624422252178192,
            null
          ]
        },
        "proposed": {
          "auc": 0.8742857142857142,
          "fpr": [
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.0,
            0.02857142857142857,
            0.05714285714285714,
            0.05714285714285714,
            0.05714285714285714,
            0.08571428571428572,
            0.08571428571428572,
            0.11428571428571428,
            0.11428571428571428,
            0.11428571428571428,
            0.14285714285714285,
            0.17142857142857143,
            0.2,
            0.2,
            0.22857142857142856,
            0.2571428571428571,
            0.2571428571428571,
            0.2571428571428571,
            0.2571428571428571,
            0.2857142857142857,
            0.3142857142857143,
            0.34285714285714286,
            0.37142857142857144,
            0.4,
            0.42857142857142855,
            0.45714285714285713,
            0.4857142857142857,
            0.4857142857142857,
            0.5142857142857142,
            0.5428571428571428,
            0.5714285714285714,
            0.6,
            0.6285714285714286,
            0.6571428571428571,
            0.6857142857142857,
            0.7142857142857143,
            0.7428571428571429,
            0.7714285714285715,
            0.8,
            0.8285714285714286,
            0.8571428571428571,
            0.8857142857142857,
            0.9142857142857143,
            0.9428571428571428,
            0.9714285714285714,
            1.0,
            1.0
          ],
          "tpr": [
            0.0,
            0.06666666666666667,
            0.13333333333333333,
            0.2,
            0.26666666666666666,
            0.3333333333333333,
            0.3333333333333333,
            0.3333333333333333,
            0.4,
            0.4666666666666667,
            0.4666666666666667,
            0.5333333333333333,
            0.5333333333333333,
            0.6,
            0.6666666666666666,
            0.6666666666666666,
            0.6666666666666666,
            0.6666666666666666,
            0.7333333333333333,
            0.7333333333333333,
            0.7333333333333333,
            0.8,
            0.8666666666666667,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            0.9333333333333333,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0,
            1.0
          ],
          "thresholds": [
            null,
            0.690218448638916,
            0.6848477125167847,
            0.6682717204093933,
            0.6307450532913208,
            0.6291308999061584,
            0.6285321712493896,
            0.6089847087860107,
            0.5808895826339722,
            0.5782588124275208,
            0.541854202747345,
            0.5337799191474915,
            0.526748776435852,
            0.5241875648498535,
            0.5224370360374451,
            0.5094422698020935,
            0.5036593079566956,
            0.4851868748664856,
            0.47451573610305786,
            0.45780861377716064,
            0.4573797583580017,
            0.442781537771225,
            0.4327486455440521,
            0.4277219772338867,
            0.4195079803466797,
            0.40675652027130127,
            0.37946006655693054,
            0.37812185287475586,
            0.37003886699676514,
            0.36526262760162354,
            0.3608555197715759,
            0.3452937602996826,
            0.34018322825431824,
            0.3367959260940552,
            0.32410895824432373,
            0.31909388303756714,
            0.30530160665512085,
            0.30403581261634827,
            0.30333027243614197,
            0.2956179976463318,
            0.29447174072265625,
            0.2882959246635437,
            0.2874433100223541,
            0.28462857007980347,
            0.2762538492679596,
            0.24366065859794617,
            0.23054632544517517,
            0.22076988220214844,
            0.2155868113040924,
            0.21258243918418884,
            0.10684768855571747,
            null
          ]
        }
      },
      "region_attribution_avg_percent": {
        "baseline": {
          "ears_region": 0.0,
          "eyes_region": 0.0,
          "muzzle_region": 0.0,
          "fur_body_region": 0.0,
          "background": 0.0
        },
        "proposed": {
          "ears_region": 0.0,
          "eyes_region": 0.0,
          "muzzle_region": 0.0,
          "fur_body_region": 0.0,
          "background": 0.0
        }
      },
      "examples": {
        "baseline": [],
        "proposed": []
      }
    }
  },
  "lowlight_config": {
    "brightness": 0.35,
    "gamma": 1.8,
    "noise_std": 0.02
  },
  "performance_factors": [
    "Image quality (blur, motion, resolution)",
    "Lighting and exposure (including lowlight)",
    "Pose/angle and occlusion (face partially visible)",
    "Background leakage (model attention outside the pet)",
    "Threshold selection for same/different decision",
    "Dataset imbalance per breed/label and domain shift vs real uploads"
  ],
  "gaps_in_parameters_context": [
    "No supervised annotations for explicit parts (ears/eyes/nose). The models learn implicit features; we approximate them using saliency + region aggregation.",
    "Label proxy (breed/name) may differ from real same-pet identity matching; this analysis uses available dataset structure.",
    "BBox is from generic COCO detector; part regions are coarse bands (not true keypoint detection)."
  ],
  "architectural_challenges": [
    "Siamese similarity relies on thresholding; optimal threshold can drift by scenario (e.g., lowlight).",
    "Capsule/attention models can be harder to interpret than plain CNNs; saliency helps but remains approximate.",
    "Ensembling (custom + MobileNetV2) improves robustness but adds sensitivity to preprocessing differences between branches."
  ]
}